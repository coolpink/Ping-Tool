jQuery(function(g){g.fn.fcbkcomplete=function(E){return this.each(function(){function x(a){return a.replace(/(<([^>]+)>)/ig,"")}function t(c,b,m,e){f.html("");var d=document.createElement("li"),h=document.createTextNode(c),o=document.createElement("a");g(d).attr({"class":"bit-box",rel:b});g(d).prepend(h);g(o).attr({"class":"closebutton",href:"#"});d.appendChild(o);n.append(d);g(o).click(function(){g(this).parent("li").fadeOut(a.animation_time,function(){y(g(this))});return!1});if(!m||e)g("#autocomplete_"+
p).remove(),m||z(1),k.children("option[value="+b+"]").length&&k.children("option[value="+b+"]").remove(),m=g(document.createElement("option")),m.addClass("selected"),m.get(0).setAttribute("selected","selected"),m.attr("value",b),m.text(c),k.append(m),a.onselect.length&&A(a.onselect,m);n.children("li.bit-box.deleted").removeClass("deleted")}function y(c){k.children("option[value="+c.attr("rel")+"]").remove();c.remove();a.onremove.length&&A(a.onremove,c);g("#autocomplete_"+p).children(".maininput").focus()}
function z(c){function b(){f.fadeOut(a.animation_time);h.children(".starting").fadeOut(a.animation_time);h.children(".nothing").fadeOut(a.animation_time)}var m=g(document.createElement("li")),e=g(document.createElement("input")),d=!1,k=!1;m.attr({"class":"bit-input",id:"autocomplete_"+p});e.attr({type:"text","class":"maininput",name:"autocomplete_fake_input",autocomplete:"off"});n.append(m.append(e));e.focus(function(){f.html()!=""&&e.val().length!=0?f.fadeIn(a.animation_time):e.val().length==0?h.children(".starting").fadeIn(a.animation_time):
h.children(".nothing").fadeIn(a.animation_time)});e.blur(b);n.click(function(){e.focus()});e.keyup(function(c){function m(){function b(){F();a.auto_select&&e.trigger("selectFirstMatch")}if(a.json_url){var c=!1;if(a.json_cache){var d=null;if(j.length==0)d=v,a.serverside_filter&&(c=typeof l[v]!="undefined");else if(a.serverside_filter){c=typeof l[j]!="undefined";if(!c){var f=!1,h;for(h in l)if(l[h].length<a.maxshownitems&&h.length<j.length&&j.indexOf(h)>=0){d=h;f=!0;break}}c=c?!0:f}a.serverside_filter||
(c=B)}a.json_cache&&c?w(j,null,b,d):(f="",a.serverside_maxshownitems&&(f="&l="+a.maxshownitems),a.culture&&(f=f+"&c="+a.culture),g.getJSON(a.json_url+"?q="+j+f,null,function(c){w(j,c,b,d);a.serverside_filter||(B=!0)}))}else w(j,null,b)}c=window.event?window.event.keyCode:c.which;if(c==27)b();else if(!(c>=36&&c<=40||c>=16&&c<=18||c==20||c==144||c==44||c==19||c==93)){var j=e.val();a.filter_case||(j=j.toLowerCase());if(d)clearTimeout(r),m(),d=!1;else if(k)k=!1;else{if(c==8&&j.length==0)if(clearTimeout(r),
r=setTimeout(function(){var b=h.children(".nothing:visible");(b.length>0?b:f).fadeOut(a.animation_time,function(){h.children(".starting").fadeIn(a.animation_time)})},a.timeout),n.children("li.bit-box.deleted").length==0)return n.children("li.bit-box:last").addClass("deleted"),!1;else n.children("li.bit-box.deleted").fadeOut(a.animation_time,function(){y(g(this));return!1});j.length!=0&&(s=0,a.newel&&G(j),clearTimeout(r),r=setTimeout(m,a.timeout))}}});e.keypress(function(b){var a=window.event?window.event.keyCode:
b.which,c=(window.event?window.event.ctrlKey:b.ctrlKey)?!0:!1;if(c&&a==32)return d=!0,b.preventDefault(),!1;if(c&&a==83)return k=!0,b.preventDefault(),!1;if(c&&(a==65||a==97))k=!0;return!0});c&&setTimeout(function(){e.focus()},1)}function w(c,b,d,e){function n(){x(g.trim(j.toLowerCase()))!=x(g.trim(f.html().toLowerCase()))?f.fadeOut(a.animation_time,function(){f.html("");f.append(j);d&&d();s>a.height?f.css({height:a.height*24+"px",overflow:"auto"}):f.css("height","auto");j!=""?f.fadeIn(a.animation_time):
c.length!=0&&h.children(".nothing").fadeIn(a.animation_time)}):j==""?h.children(".nothing").fadeIn(a.animation_time):(f.html(j),d&&d(),f.fadeIn(a.animation_time))}var q=b!=null&&b.length>0;if(a.serverside_filter){var o=!1;e==null?e=c:e!=v&&(o=!0);q?a.json_cache&&l.length<C&&(l[e]=b):b=typeof l[e]=="undefined"?[]:l[e];e=b.length;e=a.maxshownitems<e?a.maxshownitems:e;var p=null,j="";for($i=0;$i<e;$i++)if(q=b[$i],p=a.filter_case?q.caption:q.caption.toLowerCase(),(!o||o&&p.indexOf(c)>=0)&&(!a.filter_selected||
!k.children("option[value="+q.value+"]").hasClass("selected")))j+='<li rel="'+q.value+'">'+D(q.caption,c)+"</li>",s++}else{q&&g.each(b,function(b,a){!(l.length>=C)&&typeof l[a.caption]=="undefined"&&(l[a.caption]={caption:a.caption,value:a.value},u+=""+(l.length-1)+":"+a.caption+";")});o=a.maxshownitems<l.length?a.maxshownitems:l.length;b="";a.filter_case||(b="i");b=eval("/(?:^|;)\\s*(\\d+)\\s*:[^;]*?"+c+"[^;]*/g"+b);e=b.exec(u);for(j="";e!=null&&o>0;){e=l[e[1]];if(!a.filter_selected||!k.children("option[value="+
e.value+"]").hasClass("selected"))j+='<li rel="'+e.value+'">'+D(e.caption,c)+"</li>\n",s++,o--;e=b.exec(u)}}o=h.children(".starting:visible");b=h.children(".nothing:visible");e=null;o.length>0?e=o:j!=""&&c.lenght!=0&&b.length>0&&(e=b);e?e.fadeOut(a.animation_time,n):n()}function D(a,b){eval("var text = text.replace(/(.*)("+b+")(.*)/gi,'$1<em>$2</em>$3');");return a}function H(){f.children("li").mouseover(function(){f.children("li").removeClass("auto-focus");g(this).addClass("auto-focus");d=g(this)});
f.children("li").mouseout(function(){g(this).removeClass("auto-focus");d=null;a.auto_select&&g("#autocomplete_"+p).children(".maininput").trigger("selectFirstMatch")})}function F(){var c=g("#autocomplete_"+p).children(".maininput");H();f.children("li").unbind("click");f.children("li").click(function(){var b=g(this);t(b.text(),b.attr("rel"));f.fadeOut(a.animation_time)});c.bind("selectFirstMatch",function(){d=f.children("li:first");d.addClass("auto-focus");f.get(0).scrollTop=0});c.unbind("keydown");
c.keydown(function(b){var c=window.event?window.event.keyCode:b.which;c!=8&&n.children("li.bit-box.deleted").removeClass("deleted");if(c==13&&d!=null)return c=d,t(c.text(),c.attr("rel")),b.preventDefault(),d=null,!1;if(c==13&&d==null)return a.newel&&(c=g(this).val(),t(c,c),b.preventDefault(),d=null),!1;if(c==40){if(d==null)g(this).trigger("selectFirstMatch");else if(d.length==0)g(this).trigger("selectFirstMatch");else{d=d.nextAll("li:visible:first");b=parseInt(d.prevAll("li:visible").length,10);var e=
parseInt(d.nextAll("li:visible").length,10);if((b>Math.round(a.height/2)||e<=Math.round(a.height/2))&&typeof d.get(0)!="undefined")f.get(0).scrollTop=parseInt(d.get(0).scrollHeight,10)*(b-Math.round(a.height/2))}f.children("li").removeClass("auto-focus");d.addClass("auto-focus")}if(c==38){b=function(){d=f.children("li:visible:last");f.get(0).scrollTop=parseInt(d.get(0).scrollHeight,10)*(parseInt(f.children("li:visible").length,10)-Math.round(a.height/2))};if(d==null)b();else if(d.length==0)b();else if(d=
d.prevAll("li:visible:first"),b=parseInt(d.prevAll("li:visible").length,10),e=parseInt(d.nextAll("li:visible").length,10),(e>Math.round(a.height/2)||b<=Math.round(a.height/2))&&typeof d.get(0)!="undefined")f.get(0).scrollTop=parseInt(d.get(0).scrollHeight,10)*(b-Math.round(a.height/2));f.children("li").removeClass("auto-focus");d.addClass("auto-focus")}})}function G(a){f.children("li[fckb=1]").remove();if(a.length!=0){var b=g(document.createElement("li"));b.attr({rel:a,fckb:"1"}).html(a);f.prepend(b);
s++}}function A(a,b){var d="";for(i=0;i<b.get(0).attributes.length;i++)b.get(0).attributes[i].nodeValue!=null&&(d+='"_'+b.get(0).attributes[i].nodeName+'": "'+b.get(0).attributes[i].nodeValue+'",');eval(a+"("+("{"+d+" notinuse: 0}")+")")}var a=g.extend({json_url:null,height:"10",newel:!1,filter_case:!1,filter_selected:!0,complete_text:"Start to type...",nothingfound_text:"No more matches.",maxshownitems:30,timeout:280,animation_time:130,auto_select:!0,add_style_selected_on_selected:!0,serverside_maxshownitems:!0,
serverside_filter:!0,culture:null,onselect:"",onremove:""},E),n=null,f=null,h=null,s=0,l=[],v="n3eJsk9ff1cHk4",C=122,B=!1,u="",d=null,r=null,k=g(this),p=k.attr("id");(function(){k.hide();k.attr("name").indexOf("[]")==-1&&k.attr("name",k.attr("name")+"[]");n=g(document.createElement("ul"));n.attr("class","holder");k.after(n);h=g(document.createElement("div"));h.addClass("facebook-auto");var c=g(document.createElement("div"));c.addClass("default");c.addClass("starting");c.append(a.complete_text);var b=
g(document.createElement("div"));b.addClass("default");b.addClass("nothing");b.append(a.nothingfound_text);h.append(c);h.append(b);b.hide();c.hide();b.fadeOut(a.animation_time);c.fadeOut(a.animation_time);f=g(document.createElement("ul"));f.attr("id","feed_"+p);h.prepend(f);n.after(h);h.show()})();(function(){k.children("option").each(function(c,b){b=g(b);b.hasClass("selected")&&b.attr("selected")!="selected"&&b.attr("selected","selected");a.add_style_selected_on_selected&&b.attr("selected")&&b.addClass("selected");
b.hasClass("selected")?t(b.text(),b.val(),!0,b.attr("selected")):b.remove();if(!a.serverside_filter){var d=b.text();a.filter_case||(d=d.toLowerCase());l[d]={caption:b.text(),value:b.val()};u+=""+(l.length-1)+":"+b.text()+";"}})})();z(0);return this})}});